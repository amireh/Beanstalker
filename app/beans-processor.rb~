require 'rubygems'
require 'beanstalk-client'

module Beanstalker
class BeansProcessor

  # temp tube is used for job browsing and reading purposes
  @@bsh_tmp = nil
  @@connection = nil

  # MUST call before any other
  # args: valid, active beanstalk-client connection
  def self.setHandler(connection)
    @@connection = connection
    puts "-- #{@@connection.inspect} --"
    begin
      @@connection.watch("temp")
    rescue
      raise CouldNotConnect, "Could not open temp tube!"
    end
  end

  def self.is_connected?
    return ( @@connection.nil? || @@bsh_tmp.nil? ) ? false : true
  end

  # returns a hash that contains all
  # information of a given job
  def self.parseJob(job)
  end

  # returns a hash of all jobs in current tube
  def self.parseTube(tube)
    raise NotConnected if !is_connected?
  end

end
